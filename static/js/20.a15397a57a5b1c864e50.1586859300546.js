webpackJsonp([20],{"2Umt":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n("a3Yh"),o=n.n(i),a=n("u8tA"),l=n.n(a),s=n("hRKE"),r=n.n(s),c=n("3cXf"),u=n.n(c),d=n("CS1U"),p=n("HuUI"),h={components:{TinymceEditor:d.a,upload:p.a},props:{opt:{type:Object,default:function(){return null}}},data:function(){return{ruleForm:{type:"宣传教育",title:"",jj:"",orderNum:"",content:"",source:"",updateTime:new Date,author:"",fj:""},rules:{title:[{required:!0,message:"请输入标题",trigger:"blur"}],jj:[{required:!0,message:"请输入简介",trigger:"blur"}],content:[{required:!0,message:"请输入详情",trigger:"change"}]},confirmDelete:null,addnum:!0,pickerOptions:{disabledDate:function(t){return t.getTime()>Date.now()}}}},computed:{uploadParams:function(){return{type:1}},downloadurl:function(){var t="";return this.opt&&this.opt.fj&&(t=decodeURIComponent(this.opt.fj)),t}},mounted:function(){if(this.opt){this.ruleForm=this.opt,this.addnum=!1;try{this.opt.content=decodeURIComponent(this.opt.content)}catch(t){this.opt.content=this.opt.content}this.$refs.editor.tinymceHtml=this.opt.content}},methods:{changeFiles:function(t){console.log(t);var e=t.map(function(t){return t.response&&t.response.rss.dat1});this.ruleForm.fj=encodeURIComponent(e[0])},resetForm:function(t){this.$refs[t].resetFields()},backhome:function(){this.$emit("back",!1)},save:function(){var t=this;this.ruleForm.content=this.$refs.editor.tinymceHtml,this.$refs.ruleForm.validate(function(e){if(!e)return console.log("error submit!!"),!1;t.ruleForm.content=encodeURIComponent(t.ruleForm.content),t.ruleForm.updateTime=t.$utils.formatDate(t.ruleForm.updateTime,"yyyy-MM-dd");var n=t.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});t.$http.post("/api/admin/hbhd/addHbhd",{hbhdJson:u()(t.ruleForm)},function(e,i){i&&t.okdelete(i.rss.dat1),n.close()})})},editor:function(){var t=this;"object"===r()(this.ruleForm.updateTime)&&(this.ruleForm.updateTime=this.$utils.formatDate(this.ruleForm.updateTime,"yyyy-MM-dd")),this.ruleForm.content=this.$refs.editor.tinymceHtml,this.$refs.ruleForm.validate(function(e){if(!e)return console.log("error submit!!"),!1;t.ruleForm.content=encodeURIComponent(t.ruleForm.content);var n=t.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});t.$http.post("/api/admin/hbhd/updateHbhd",{json:u()(t.ruleForm)},function(e,i){i&&t.okdelete(t.ruleForm),n.close()})})},okdelete:function(t){var e=this;e.confirmDelete=function(n){var i=this;e.confirmDelete=null,n&&this.$http.post("/api/admin/hbhd/publishHbhd",{id:t},function(t,n){i.$message({showClose:!0,message:"发布成功",type:"success"}),e.$emit("back",!0)}),e.$emit("back",!0)}},escape2Html:function(t){var e={lt:"<",gt:">",nbsp:" ",amp:"&",quot:'"',ldquo:'"',rdquo:'"'};return t.replace(/&(lt|gt|nbsp|amp|quot|ldquo|rdquo);/gi,function(t,n){return e[n]})}}},m={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{},[n("div",{staticClass:"flex-row align-items-center",staticStyle:{width:"calc(100% - 42px)",height:"50px",border:"1px #E4E4E4 solid","padding-left":"20px"}},[n("el-button",{staticClass:"el-icon-view",attrs:{type:"primary",size:"small"},on:{click:function(e){t.showcont=!0}}},[t._v(" 预览")]),t._v(" "),t.addnum?n("el-button",{staticClass:"el-icon-collection",attrs:{type:"success",size:"small"},on:{click:function(e){return t.save()}}},[t._v(" 保存")]):n("el-button",{staticClass:"el-icon-collection",attrs:{type:"success",size:"small"},on:{click:function(e){return t.editor()}}},[t._v(" 保存")]),t._v(" "),n("el-button",{staticClass:"el-icon-right",attrs:{type:"warning",size:"small"},on:{click:function(e){return t.backhome()}}},[t._v(" 退出")])],1),t._v(" "),n("div",{staticStyle:{border:"1px solid #e4e4e4",margin:"10px 0","padding-top":"10px",height:"calc(100vh - 190px)",width:"calc(100% - 22px)"}},[n("v-scroll",{staticStyle:{width:"100%",height:"100%"},attrs:{ops:t.$configs.opts.scroll.lightgray}},[n("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:t.ruleForm,rules:t.rules,"label-width":"100px",size:"mini"}},[n("el-form-item",{attrs:{label:"类别",prop:"type"}},[n("el-input",{staticStyle:{width:"30%"},attrs:{disabled:!0},model:{value:t.ruleForm.type,callback:function(e){t.$set(t.ruleForm,"type",e)},expression:"ruleForm.type"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"标题",prop:"title"}},[n("el-input",{model:{value:t.ruleForm.title,callback:function(e){t.$set(t.ruleForm,"title",e)},expression:"ruleForm.title"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"简介",prop:"jj"}},[n("el-input",{attrs:{type:"textarea"},model:{value:t.ruleForm.jj,callback:function(e){t.$set(t.ruleForm,"jj",e)},expression:"ruleForm.jj"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"详情",prop:"content"}},[n("tinymce-editor",{ref:"editor",model:{value:t.ruleForm.content,callback:function(e){t.$set(t.ruleForm,"content",e)},expression:"ruleForm.content"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"来源",prop:"source"}},[n("el-input",{model:{value:t.ruleForm.source,callback:function(e){t.$set(t.ruleForm,"source",e)},expression:"ruleForm.source"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"时间",prop:"updateTime"}},[n("el-date-picker",{staticStyle:{width:"30%"},attrs:{type:"date","picker-options":t.pickerOptions,placeholder:"选择日期"},model:{value:t.ruleForm.updateTime,callback:function(e){t.$set(t.ruleForm,"updateTime",e)},expression:"ruleForm.updateTime"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"作者",prop:"author"}},[n("el-input",{model:{value:t.ruleForm.author,callback:function(e){t.$set(t.ruleForm,"author",e)},expression:"ruleForm.author"}})],1),t._v(" "),n("el-form-item",{staticStyle:{width:"50%"},attrs:{label:"添加附件",prop:"other"}},[n("upload",{attrs:{params:t.uploadParams},on:{change:t.changeFiles}}),t._v(" "),t.downloadurl?n("span",[n("a",{staticStyle:{"text-decoration":"none"},attrs:{href:t.downloadurl,target:"_blank"}},[t._v("查看附件")])]):t._e()],1),t._v(" "),n("el-form-item",{attrs:{label:"排序",prop:"orderNum"}},[n("el-select",{attrs:{placeholder:"默认"},model:{value:t.ruleForm.orderNum,callback:function(e){t.$set(t.ruleForm,"orderNum",e)},expression:"ruleForm.orderNum"}},[n("el-option",{attrs:{label:"1",value:"1"}}),t._v(" "),n("el-option",{attrs:{label:"2",value:"2"}}),t._v(" "),n("el-option",{attrs:{label:"3",value:"3"}})],1)],1)],1)],1)],1),t._v(" "),n("v-dialog",{attrs:{width:"400px",callback:t.confirmDelete,show:!!t.confirmDelete}},[[n("div",{staticStyle:{padding:"2em","font-weight":"600"}},[t._v("保存成功"),n("p",{staticStyle:{"font-size":"14px","font-weight":"400"}},[t._v("你所提交的文章保存成功，是否发布？")])])]],2)],1)},staticRenderFns:[]};var f=n("C7Lr")(h,m,!1,function(t){n("5WHA")},"data-v-281123c7",null).exports,g={components:{vuescroll:l.a,hbhdcont:f},data:function(){var t;return t={keyword:"",tableData:[{id:35405,xuhao:2,type:"环保咨询",title:"生态环境保护工作会议展开。。。。",info:"生态环境保护工作会议展开。。。",status:"以显示",name:"张三",date:"2016-05-02"}],num:0,multipleSelection:[],type:"",maxheight:null,selectedarr:[],pageNum:1,pageSize:10,total:0,current:"xcjy",currentView:"xcjy",editor:!1,showcont:!1,confirmDelete:null},o()(t,"selectedarr",[]),o()(t,"gzts",!0),o()(t,"opt",null),o()(t,"ul",!0),t},created:function(){var t=this;this.$bus.$on("maxheight",function(e){t.maxheight=e-270})},computed:{allpage:function(){return Math.ceil(this.total/this.pageSize)}},watch:{currentView:function(t){this.routeTo(t)},keyword:function(t){this.getdata()}},mounted:function(){var t=document.body.clientHeight;this.maxheight=t-270,this.getdata()},methods:{hidelist:function(){this.ul=!this.ul},handleSizeChange:function(t){this.pageSize=t,this.getdata()},handleCurrentChange:function(t){this.pageNum=t,this.getdata()},getdata:function(){var t=this,e={type:this.type,pageNum:this.pageNum,pageSize:this.pageSize,keyword:this.keyword};this.$http.post("/api/admin/hbhd/getHbhdFy",e,function(e,n){t.tableData=n.rss.dat1,t.total=n.result.total||15,t.tableData.forEach(function(t){0==t.statu?(t.statutype="待发布",t.author=null):t.statutype="已显示"})})},sortByDate:function(t,e){return t.id-e.id},add:function(){this.opt=null,this.showcont=!0},handleEdit:function(t){var e=this,n=this.$loading({lock:!0,text:"加载中",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});this.$http.post("/api/admin/hbhd/getHbhdByid",{id:t.id},function(t,i){n.close(),e.showcont=!0,e.opt=i.rss.dat1})},cdata:function(t){this.current=t,this.currentView=t},muldelete:function(){var t=this;this.num?t.confirmDelete=function(e){t.confirmDelete=null,e&&t.okdelete(),t.$refs.multipleTable.clearSelection()}:this.$message({message:"请先选择数据",type:"warning"})},okdelete:function(){var t=this;this.$http.post("/api/admin/hbhd/deleteAllIds",{ids:this.selectedarr},function(e,n){t.$message({showClose:!0,message:"删除成功",type:"success"}),t.getdata()})},handleDelete:function(t,e){var n=this,i=[];i.push(e.id),this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){n.$message({type:"success",message:"删除成功!"}),n.$http.post("/api/admin/hbhd/deleteAllIds",{ids:i},function(t,e){n.getdata()})}).catch(function(){n.$message({type:"info",message:"已取消删除"})})},handleSelectionChange:function(t){this.multipleSelection=t,this.num=t.length;var e=[];t.forEach(function(t){e.push(t.id)}),this.selectedarr=e},cx:function(t){var e=this;this.$http.post("/api/admin/hbhd/chexiaoPublishByid",{id:t.id},function(t,n){e.getdata()})},fb:function(t){var e=this;this.$http.post("/api/admin/hbhd/publishHbhd",{id:t.id},function(t,n){e.getdata()})},top:function(t){var e=this;this.$http.post("/api/admin/hbhd/zdByid",{id:t.id},function(t,n){e.$message({showClose:!0,message:"置顶成功",type:"success"}),e.getdata()})},back:function(t){t&&this.getdata(),this.showcont=!1}}},v={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{},[n("div",{staticClass:"flex-row align-items-center",staticStyle:{width:"calc(100% - 22px)",height:"50px",border:"1px #E4E4E4 solid","padding-left":"20px"}},[n("el-button",{directives:[{name:"show",rawName:"v-show",value:"xcjy"==t.currentView,expression:"currentView=='xcjy'"}],staticClass:"el-icon-plus",attrs:{type:"warning",size:"small"},on:{click:function(e){return t.add()}}},[t._v(" 添加内容")]),t._v(" "),n("el-button",{staticClass:"el-icon-delete-solid",attrs:{type:"danger",size:"small"},on:{click:function(e){return t.muldelete()}}},[t._v(" 批量删除")])],1),t._v(" "),n("div",{staticClass:"flex-row"},[n("div",{staticClass:"cursor-p flex-column",staticStyle:{"margin-top":"5px",width:"170px",border:"1px solid #e4e4e4","text-align":"left","font-size":"14px"}},[n("div",{staticStyle:{"text-align":"left",background:"#61A7CF",padding:"5px",color:"white"}},[t._v("内容分类列表")]),t._v(" "),t._m(0),t._v(" "),n("ul",[n("li",{staticClass:"iconfont icon-baocun",class:{active:"xcjy"==t.current},staticStyle:{color:"#C6699F"}},[n("span",{staticStyle:{color:"black"},on:{click:function(e){return t.cdata("xcjy")}}},[t._v("宣传教育")])])]),t._v(" "),n("div",{staticClass:"iconfont icon-bianzu",staticStyle:{"margin-top":"5px","padding-left":"40px",color:"#FF9800"},on:{click:t.hidelist}},[n("span",{staticStyle:{color:"black"}},[t._v("公众投诉")])]),t._v(" "),t.ul?n("ul",{staticStyle:{"margin-left":"8px"}},[n("li",{staticClass:"iconfont icon-baocun",class:{active:"tsnr"==t.current},staticStyle:{color:"#C6699F"}},[n("span",{staticStyle:{color:"black"},on:{click:function(e){return t.cdata("tsnr")}}},[t._v("投诉内容")])]),t._v(" "),n("li",{staticClass:"iconfont icon-baocun",class:{active:"clhf"==t.current},staticStyle:{color:"#C6699F"}},[n("span",{staticStyle:{color:"black"},on:{click:function(e){return t.cdata("clhf")}}},[t._v("处理回复")])])]):t._e()]),t._v(" "),n("div",{staticClass:"border-normal",staticStyle:{width:"calc(100% - 170px)",margin:"5px 0 0 5px"}},[n("div",{staticClass:"searchinput"},[n("el-pagination",{attrs:{background:"","page-sizes":[10,20,30],"page-size":t.pageSize,layout:"sizes"},on:{"size-change":t.handleSizeChange}}),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model.lazy",value:t.keyword,expression:"keyword",modifiers:{lazy:!0}}],staticStyle:{height:"20px","text-indent":"5px"},attrs:{placeholder:"输入关键字搜索"},domProps:{value:t.keyword},on:{change:function(e){t.keyword=e.target.value}}})],1),t._v(" "),n("el-table",{ref:"multipleTable",attrs:{data:t.tableData,"max-height":t.maxheight,size:"small","default-sort":{prop:"",order:"descending"}},on:{"selection-change":t.handleSelectionChange}},[n("el-table-column",{attrs:{"min-width":"55",type:"selection"}}),t._v(" "),n("el-table-column",{attrs:{prop:"id",label:"ID",sortable:"","min-width":"60"}}),t._v(" "),n("el-table-column",{attrs:{label:"所属分类","min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",{},[t._v(t._s(e.row.type))])]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"标题","min-width":"140"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",{staticClass:"limit"},[t._v(t._s(e.row.title))])]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"简介","min-width":"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",{staticClass:"limit"},[t._v(t._s(e.row.jj))])]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"updateTime",label:"添加时间",sortable:"","min-width":"180"}}),t._v(" "),n("el-table-column",{attrs:{label:"状态","min-width":"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",{},[t._v(t._s(e.row.statutype))])]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"发布人","min-width":"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",{},[t._v(t._s(e.row.author||"--"))])]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"操作","min-width":"130"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("div",{staticClass:"flex-row"},[n("span",{staticClass:"iconfont icon-bianji cursor-p color-bianji",staticStyle:{"font-size":"15px"},on:{click:function(n){return t.handleEdit(e.row)}}},[n("p",[t._v("编辑")])]),t._v(" "),e.row.statu?n("span",{staticClass:"iconfont icon-chexiao cursor-p color-fabu",staticStyle:{"font-size":"15px"},on:{click:function(n){return t.cx(e.row)}}},[n("p",[t._v("撤销")])]):n("span",{staticClass:"iconfont icon-fabu cursor-p color-fabu",staticStyle:{"font-size":"15px"},on:{click:function(n){return t.fb(e.row)}}},[n("p",[t._v("发布")])]),t._v(" "),n("span",{staticClass:"iconfont icon-shanchu-dianji cursor-p color-shanchu",staticStyle:{"font-size":"15px"},on:{click:function(n){return t.handleDelete(e.$index,e.row)}}},[n("p",[t._v("删除")])]),t._v(" "),n("span",{staticClass:"iconfont icon-top cursor-p ",staticStyle:{"font-size":"15px"},on:{click:function(n){return t.top(e.row)}}},[n("p",[t._v("置顶")])])])]}}])})],1)],1)]),t._v(" "),n("div",{staticClass:"flex-row text-12 justify-between ",staticStyle:{"margin-left":"170px","margin-top":"10px"}},[n("div",{staticStyle:{"text-align":"center","line-height":"2.5em","margin-left":"2em"}},[t._v("第"+t._s(t.pageNum)+"页,共"+t._s(t.allpage)+"页，共"+t._s(t.total)+"条")]),t._v(" "),n("el-pagination",{attrs:{background:"","current-page":t.pageNum,"page-sizes":[10,20,30],"page-size":t.pageSize,layout:"sizes, prev, pager, next",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.pageNum=e},"update:current-page":function(e){t.pageNum=e}}})],1),t._v(" "),n("v-dialog",{attrs:{width:"400px",callback:t.confirmDelete,show:!!t.confirmDelete}},[[n("div",{staticStyle:{padding:"20px 30px","font-weight":"600"}},[t._v("确定删除所选的"+t._s(t.num)+"条信息吗？"),n("p",{staticStyle:{"font-size":"14px","font-weight":"400"}},[t._v("删除后数据不可恢复，请谨慎选择")])])]],2),t._v(" "),t.showcont?n("div",{staticClass:"addcontent"},[n("hbhdcont",{attrs:{opt:t.opt},on:{back:t.back}})],1):t._e()],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"iconfont icon-bianzu",staticStyle:{"margin-top":"20px","margin-left":"15px",color:"#FF9800"}},[e("span",{staticStyle:{color:"black"}},[this._v("全部分类")])])}]};var b=n("C7Lr")(g,v,!1,function(t){n("FAaR"),n("rewt")},"data-v-e7ce92ae",null);e.default=b.exports},"5WHA":function(t,e){},FAaR:function(t,e){},rewt:function(t,e){}});