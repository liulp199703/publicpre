webpackJsonp([16],{"+Qdb":function(e,t){},ObTj:function(e,t){},"ak/G":function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o("CS1U"),l=o("x+Nl"),i={components:{TinymceEditor:r.a,uploader:l.a},mounted:function(){this.data=this.$route.params.data,this.getdata()},computed:{uploadParams:function(){return{type:1}},downloadurl:function(){var e="";return this.ruleForm&&this.ruleForm.fj&&(e=decodeURIComponent(this.ruleForm.fj)),e}},data:function(){return{ruleForm:{id:null,type:"",title:"",jj:"",fj:"",orderNum:"",content:"",author:""},data:{},rules:{type:[{required:!0,message:"请选择类别",trigger:"change"}],title:[{required:!0,message:"请输入标题",trigger:"blur"}],jj:[{required:!0,message:"请输入简介",trigger:"blur"}],content:[{required:!0,message:"请输入详情",trigger:"change"}]},confirmDelete:null,pickerOptions:{disabledDate:function(e){return e.getTime()>Date.now()}}}},methods:{resetForm:function(e){this.$refs[e].resetFields()},backhome:function(){this.routeTo("fbgl")},changeFiles:function(e){console.log(e);var t=e.map(function(e){return e.response&&e.response.rss.dat1});this.ruleForm.fj=encodeURIComponent(t[0])},getdata:function(){var e=this;console.log(this.data);var t={id:this.data.id};this.$http.post("/api/admin/zdybd/selectByid",t,function(t,o){var r=o.rss.dat1.zdyBd,l=o.rss.dat1.zdyBdContent;if(e.ruleForm.type=r.type,e.ruleForm.id=r.id,e.ruleForm.title=r.title,e.ruleForm.jj=l.jj,e.ruleForm.orderNum=r.orderNum,e.ruleForm.content=l.content,e.ruleForm.author=r.author,e.ruleForm.fj=l.fj,l.content)try{l.content=decodeURIComponent(l.content)}catch(e){l.content=l.content}e.$refs.editor.tinymceHtml=l.content,1==e.ruleForm.type?e.ruleForm.type="环境治理光荣榜":2==e.ruleForm.type&&(e.ruleForm.type="超标排放曝光"),console.log(decodeURIComponent(e.ruleForm.fj))})},escape2Html:function(e){var t={lt:"<",gt:">",nbsp:" ",amp:"&",quot:'"',ldquo:'"',rdquo:'"'};return e.replace(/&(lt|gt|nbsp|amp|quot|ldquo|rdquo);/gi,function(e,o){return t[o]})},save:function(){var e=this;console.log(this.ruleForm),this.ruleForm.content=this.$refs.editor.tinymceHtml;var t=encodeURIComponent(this.ruleForm.content);this.ruleForm.content=t,"环境治理光荣榜"==this.ruleForm.type?this.ruleForm.type=1:"超标排放曝光"==this.ruleForm.type&&(this.ruleForm.type=2),this.$http.post("/api/admin/zdybd/updateZdyBd",this.ruleForm,function(t,o){t?e.$message({type:"success",message:"保存成功"}):e.$message({type:"info",message:"保存失败"})})},okdelete:function(){var e=this;e.confirmDelete=function(t){e.confirmDelete=null,t&&this.$http.post("/api/admin/shouye/publishXw",{id:9},function(t,o){console.log(o),e.$emit("back",!1)})}}}},n={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{},[o("div",{staticClass:"flex-row align-items-center",staticStyle:{width:"calc(100% - 42px)",height:"50px",border:"1px #E4E4E4 solid","padding-left":"20px"}},[o("el-button",{staticClass:"el-icon-view",attrs:{type:"primary",size:"small"},on:{click:function(t){e.showcont=!0}}},[e._v(" 预览")]),e._v(" "),o("el-button",{staticClass:"el-icon-collection",attrs:{type:"success",size:"small"},on:{click:function(t){return e.save()}}},[e._v(" 保存")]),e._v(" "),o("el-button",{staticClass:"el-icon-right",attrs:{type:"warning",size:"small"},on:{click:function(t){return e.backhome()}}},[e._v(" 退出")])],1),e._v(" "),o("div",{staticStyle:{border:"1px solid #e4e4e4",margin:"10px 0","padding-top":"10px",height:"calc(100vh - 190px)",width:"calc(100% - 22px)"}},[o("v-scroll",{staticStyle:{width:"100%",height:"100%"},attrs:{ops:e.$configs.opts.scroll.lightgray}},[o("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px",size:"mini"}},[o("el-form-item",{attrs:{label:"类别",prop:"type"}},[o("el-select",{attrs:{placeholder:"请选择"},model:{value:e.ruleForm.type,callback:function(t){e.$set(e.ruleForm,"type",t)},expression:"ruleForm.type"}},[o("el-option",{attrs:{label:"环境治理光荣榜",value:"环境治理光荣榜"}}),e._v(" "),o("el-option",{attrs:{label:"超标排放曝光",value:"超标排放曝光"}})],1)],1),e._v(" "),o("el-form-item",{attrs:{label:"标题",prop:"title"}},[o("el-input",{model:{value:e.ruleForm.title,callback:function(t){e.$set(e.ruleForm,"title",t)},expression:"ruleForm.title"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"简介",prop:"jj"}},[o("el-input",{attrs:{type:"textarea"},model:{value:e.ruleForm.jj,callback:function(t){e.$set(e.ruleForm,"jj",t)},expression:"ruleForm.jj"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"详情",prop:"content"}},[o("tinymce-editor",{ref:"editor",model:{value:e.ruleForm.content,callback:function(t){e.$set(e.ruleForm,"content",t)},expression:"ruleForm.content"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"来源",prop:"source"}},[o("el-input",{model:{value:e.ruleForm.source,callback:function(t){e.$set(e.ruleForm,"source",t)},expression:"ruleForm.source"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"时间",prop:"updateTime"}},[o("el-date-picker",{staticStyle:{width:"30%"},attrs:{type:"date","picker-options":e.pickerOptions,placeholder:"选择日期"},model:{value:e.ruleForm.updateTime,callback:function(t){e.$set(e.ruleForm,"updateTime",t)},expression:"ruleForm.updateTime"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"作者",prop:"author"}},[o("el-input",{model:{value:e.ruleForm.author,callback:function(t){e.$set(e.ruleForm,"author",t)},expression:"ruleForm.author"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"添加附件",prop:"other"}},[o("uploader",{attrs:{params:e.uploadParams},on:{change:e.changeFiles}}),e._v(" "),e.downloadurl?o("span",[o("a",{staticStyle:{"text-decoration":"none"},attrs:{href:e.downloadurl,target:"_blank"}},[e._v("查看附件")])]):e._e()],1),e._v(" "),o("el-form-item",{attrs:{label:"排序",prop:"orderNum"}},[o("el-select",{attrs:{placeholder:"默认"},model:{value:e.ruleForm.orderNum,callback:function(t){e.$set(e.ruleForm,"orderNum",t)},expression:"ruleForm.orderNum"}},[o("el-option",{attrs:{label:"1",value:"1"}}),e._v(" "),o("el-option",{attrs:{label:"2",value:"2"}}),e._v(" "),o("el-option",{attrs:{label:"3",value:"3"}}),e._v(" "),o("el-option",{attrs:{label:"默认",value:"4"}})],1)],1)],1)],1)],1),e._v(" "),o("v-dialog",{attrs:{width:"400px",callback:e.confirmDelete,show:!!e.confirmDelete}},[[o("div",{staticStyle:{padding:"2em","font-weight":"600"}},[e._v("保存成功"),o("p",{staticStyle:{"font-size":"14px","font-weight":"400"}},[e._v("你所提交的文章保存成功，是否发布？")])])]],2)],1)},staticRenderFns:[]};var a=o("C7Lr")(i,n,!1,function(e){o("+Qdb")},"data-v-aeb2e372",null);t.default=a.exports},"x+Nl":function(e,t,o){"use strict";var r={props:{params:{type:[Object],default:function(){return{type:1}}}},data:function(){return{acceptFileType:".pdf,.jpg,.jpeg,.png,.docx,.xlsx",filelist:[]}},computed:{fileCount:function(){return this.filelist.length}},mounted:function(){},methods:{getFiles:function(){return filelist},onChange:function(e,t){console.log(t),this.filelist=t,this.$emit("change",t)},uploadFile:function(){this.uploadLoading=!1;var e=this;this.fileList=[],this.uploadTemplateDialog=!0,setTimeout(function(){e.$refs.upload.clearFiles()},100)},handleExceed:function(e,t){this.$message.warning("最多只能选择4个文件!")},submitUpload:function(){console.log("submitUpload..."),this.uploadLoading=!0;var e=this;setTimeout(function(){1==e.$refs.upload.$children[0].fileList.length?e.$refs.upload.submit():(e.uploadLoading=!1,e.$message({type:"error",showClose:!0,duration:3e3,message:"请选择文件!"}))},100)},handleRemove:function(e,t){console.log(e,t)},handlePreview:function(e){console.log(e)},onSuccess:function(e,t,o){console.log(e),this.downloadLoading.close(),this.uploadLoading=!1,this.uploadTemplateDialog=!1},onError:function(e,t,o){this.downloadLoading.close(),this.uploadLoading=!1,this.uploadTemplateDialog=!1,this.$message({type:"error",showClose:!0,duration:6e4,message:"请求失败! error:"+e})},checkFile:function(e){var t=e.name.substring(e.name.lastIndexOf("."));return!(this.acceptFileType.indexOf(t)<0)||(this.uploadTemplateDialog=!1,this.$message({type:"error",showClose:!0,duration:3e3,message:"文件类型不在列表"+this.acceptFileType+"中!"}),!1)},checkFileSize:function(e){var t=e.size;return console.log(t),!(t>2097152)||(this.uploadTemplateDialog=!1,this.$message({type:"error",showClose:!0,duration:3e3,message:"文件大于2M!"}),!1)},beforeUpload:function(e){console.log("beforeUpload..."),console.log(e);e.name.substring(e.name.lastIndexOf(".")+1);return this.checkFile(e)&&this.checkFileSize(e)?(this.downloadLoading=this.$loading({lock:!0,text:"数据导入中...",spinner:"el-icon-loading",background:"rgba(0,0,0,0.7)"}),!0):(this.uploadTemplateDialog=!1,!1)}}},l={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{action:"http://211.159.186.65:28890/api/fj/uploadFj",data:e.params,accept:e.acceptFileType,multiple:"",limit:4,"on-change":e.onChange,"on-exceed":e.handleExceed,"before-upload":e.beforeUpload,"on-preview":e.handlePreview,"on-success":e.onSuccess,"on-error":e.onError,"on-remove":e.handleRemove,"file-list":e.filelist}},[o("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[e._v("请选择文件")]),e._v(" "),o("label",{staticClass:"el-upload_tip text-14",attrs:{slot:"tip"},slot:"tip"},[e._v("支持.pdf,.jpg,jpeg,.png,.docx,.xlsx")])],1)],1)},staticRenderFns:[]};var i=o("C7Lr")(r,l,!1,function(e){o("ObTj")},"data-v-76c23dfc",null);t.a=i.exports}});